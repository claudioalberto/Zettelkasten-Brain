/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
__export(exports, {
  default: () => BibleLinkerPlugin
});
var import_obsidian5 = __toModule(require("obsidian"));

// src/modals/copy-verse-modal.ts
var import_obsidian3 = __toModule(require("obsidian"));

// src/utils/convert-link.ts
var import_obsidian2 = __toModule(require("obsidian"));

// src/utils/regexes.ts
var oneVerseRegEx = new RegExp(/([^,:#]+)[,#.:;]\s*(\d+)\s*$/);
var multipleVersesRegEx = new RegExp(/([^,:#]+)[,#.:;]\s*(\d+)\s*[-.=]\s*(\d+)\s*$/);
var bookAndChapterRegexForOBSK = /([^,:#]+)\s(\d+)/;

// src/modals/link-verse-modal.ts
var import_obsidian = __toModule(require("obsidian"));
var LinkType;
(function(LinkType2) {
  LinkType2["Basic"] = "Basic";
  LinkType2["Embedded"] = "Embedded";
  LinkType2["Invisible"] = "Invisible";
})(LinkType || (LinkType = {}));
var LinkVerseModal = class extends import_obsidian.Modal {
  constructor(app, settings, onSubmit) {
    super(app);
    this.handleInput = () => __async(this, null, function* () {
      try {
        const res = yield getLinksToVerses(this.app, this.userInput, this.linkType, this.useNewLine, this.pluginSettings);
        this.close();
        this.onSubmit(res);
      } catch (err) {
        return;
      }
    });
    this.onSubmit = onSubmit;
    this.pluginSettings = settings;
    this.linkType = this.pluginSettings.linkTypePreset;
    this.useNewLine = this.pluginSettings.newLinePreset;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: "Create Obsidian links from Bible reference" });
    new import_obsidian.Setting(contentEl).setName("Insert reference").addText((text) => text.onChange((value) => {
      this.userInput = value;
    }).inputEl.focus());
    new import_obsidian.Setting(contentEl).setName("Link type").addDropdown((dropdown) => {
      dropdown.addOption(LinkType.Basic, LinkType.Basic);
      dropdown.addOption(LinkType.Embedded, LinkType.Embedded);
      dropdown.addOption(LinkType.Invisible, LinkType.Invisible);
      dropdown.onChange((value) => this.linkType = value);
      dropdown.setValue(this.pluginSettings.linkTypePreset);
    });
    new import_obsidian.Setting(contentEl).setName("Each link on new line?").addToggle((tgl) => {
      tgl.setValue(this.pluginSettings.newLinePreset);
      tgl.onChange((val) => this.useNewLine = val);
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Link").setCta().onClick(this.handleInput);
    });
    contentEl.onkeydown = (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        this.handleInput();
      }
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/utils/convert-link.ts
function getLinksToVerses(app, userInput, linkType, useNewLine, settings) {
  return __async(this, null, function* () {
    let { bookAndChapter, beginVerse, endVerse } = parseUserInput(userInput);
    bookAndChapter = capitalize(bookAndChapter);
    if (settings.verifyFilesWhenLinking) {
      const { fileName, tFile } = getFileFromBookAndChapter(app, bookAndChapter);
      if (!tFile) {
        new import_obsidian2.Notice(`File "${fileName}" does not exist and verify files is set to true`);
        throw `File ${fileName} does not exist, verify files = true`;
      }
    }
    if (beginVerse > endVerse) {
      new import_obsidian2.Notice("Begin verse is bigger than end verse");
      throw "Begin verse is bigger than end verse";
    }
    let res = "";
    const beginning = linkType === LinkType.Embedded ? "!" : "";
    const ending = linkType === LinkType.Invisible ? "|" : "";
    for (let i = beginVerse; i <= endVerse; i++) {
      res += `${beginning}[[${bookAndChapter}${settings.linkSeparator}${settings.versePrefix}${i}${ending}]]`;
      if (useNewLine) {
        res += "\n";
      }
    }
    return res;
  });
}
function getTextOfVerses(app, userInput, settings) {
  return __async(this, null, function* () {
    let { bookAndChapter, beginVerse, endVerse } = parseUserInput(userInput);
    bookAndChapter = capitalize(bookAndChapter);
    const { fileName, tFile } = getFileFromBookAndChapter(app, bookAndChapter);
    if (tFile) {
      return yield createCopyOutput(app, tFile, bookAndChapter, fileName, beginVerse, endVerse, settings);
    } else {
      new import_obsidian2.Notice(`File ${bookAndChapter} not found`);
      throw "File not found";
    }
  });
}
function getFileFromBookAndChapter(app, bookAndChapter) {
  let fileName = bookAndChapter;
  let tFile = app.metadataCache.getFirstLinkpathDest(fileName, "/");
  if (!tFile) {
    fileName = tryConvertToOBSKFileName(fileName);
    tFile = app.metadataCache.getFirstLinkpathDest(fileName, "/");
  }
  return { fileName, tFile };
}
function parseUserInput(userInput) {
  let bookAndChapter;
  let beginVerse;
  let endVerse;
  switch (true) {
    case oneVerseRegEx.test(userInput): {
      const [, matchedChapter, matchedVerse] = userInput.match(oneVerseRegEx);
      bookAndChapter = matchedChapter;
      beginVerse = Number(matchedVerse);
      endVerse = Number(matchedVerse);
      break;
    }
    case multipleVersesRegEx.test(userInput): {
      const [, matchedChapter, matchedBeginVerse, matchedEndVerse] = userInput.match(multipleVersesRegEx);
      bookAndChapter = matchedChapter;
      beginVerse = Number(matchedBeginVerse);
      endVerse = Number(matchedEndVerse);
      break;
    }
    default: {
      new import_obsidian2.Notice(`Wrong format "${userInput}"`);
      throw "Could not parse user input";
    }
  }
  return { bookAndChapter, beginVerse, endVerse };
}
function capitalize(str) {
  str = str.toLocaleLowerCase();
  for (let i = 0; i < str.length; i++) {
    if (/[^\s\d.,#-]/.test(str.charAt(i))) {
      return str.slice(0, i) + str.charAt(i).toUpperCase() + str.slice(i + 1);
    }
  }
  return str;
}
function getVerseText(verseNumber, headings, lines, keepNewlines, newLinePrefix) {
  if (verseNumber >= headings.length) {
    new import_obsidian2.Notice("Verse out of range for given file");
    throw `VerseNumber ${verseNumber} is out of range of headings with length ${headings.length}`;
  }
  const headingLine = headings[verseNumber].position.start.line;
  if (headingLine + 1 >= lines.length) {
    new import_obsidian2.Notice("Logical error - please create issue on plugin's GitHub with your input and the file you were referencing. Thank you!");
    throw `HeadingLine ${headingLine + 1} is out of range of lines with length ${lines}`;
  }
  let output = "";
  let line = "";
  let i = 1;
  let isFirst = true;
  while (true) {
    line = lines[headingLine + i];
    if (/#/.test(line) || !line && !isFirst) {
      break;
    }
    i++;
    if (line) {
      if (!isFirst) {
        output += keepNewlines ? `
${newLinePrefix}` : " ";
      }
      isFirst = false;
      output += line;
    }
  }
  return output;
}
function tryConvertToOBSKFileName(bookAndChapter) {
  if (bookAndChapterRegexForOBSK.test(bookAndChapter)) {
    let [, book, number] = bookAndChapter.match(bookAndChapterRegexForOBSK);
    if (number.length == 1) {
      number = `0${number}`;
    }
    return `${book}-${number}`;
  }
}
function replaceNewline(input) {
  return input.replace(/\\n/g, "\n");
}
function createCopyOutput(app, tFile, userChapterInput, fileName, beginVerse, endVerse, settings) {
  return __async(this, null, function* () {
    const file = app.vault.read(tFile);
    const lines = (yield file).split(/\r?\n/);
    const verseHeadingLevel = settings.verseHeadingLevel;
    const headings = app.metadataCache.getFileCache(tFile).headings.filter((heading) => !verseHeadingLevel || heading.level === verseHeadingLevel);
    const beginVerseNoOffset = beginVerse;
    const endVerseNoOffset = endVerse;
    beginVerse += settings.verseOffset;
    endVerse += settings.verseOffset;
    if (beginVerse > endVerse) {
      new import_obsidian2.Notice("Begin verse is bigger than end verse");
      throw "Begin verse is bigger than end verse";
    }
    if (headings.length <= beginVerse) {
      new import_obsidian2.Notice("Begin verse out of range of chapter");
      throw "Begin verse out of range of chapter";
    }
    let res = settings.prefix;
    const postfix = settings.postfix ? replaceNewline(settings.postfix) : " ";
    if (beginVerse === endVerse) {
      res += `[[${fileName}#${headings[beginVerse].heading}|${userChapterInput}${settings.oneVerseNotation}${beginVerseNoOffset}]]${postfix}`;
    } else if (settings.linkEndVerse) {
      res += `[[${fileName}#${headings[beginVerse].heading}|${userChapterInput}${settings.multipleVersesNotation}${beginVerseNoOffset}-]]`;
      res += `[[${fileName}#${headings[endVerse].heading}|${endVerseNoOffset}]]${postfix}`;
    } else {
      res += `[[${fileName}#${headings[beginVerse].heading}|${userChapterInput}${settings.multipleVersesNotation}${beginVerseNoOffset}-${endVerseNoOffset}]]${postfix}`;
    }
    for (let i = beginVerse; i <= endVerse; i++) {
      let eachVersePrefix = "";
      if (settings.eachVersePrefix) {
        eachVersePrefix += settings.eachVersePrefix.replace("{n}", (i - settings.verseOffset).toString());
      }
      const verseText = getVerseText(i, headings, lines, settings.newLines, settings.prefix);
      if (settings.newLines) {
        res += "\n" + settings.prefix + eachVersePrefix + verseText;
      } else {
        res += eachVersePrefix + verseText + " ";
      }
    }
    if (beginVerse == endVerse || !settings.useInvisibleLinks)
      return res;
    if (settings.newLines) {
      res += `
${settings.prefix}`;
    }
    for (let i = beginVerse; i <= endVerse; i++) {
      res += `[[${fileName}#${headings[i].heading}|]]`;
    }
    return res;
  });
}

// src/modals/copy-verse-modal.ts
var CopyVerseModal = class extends import_obsidian3.Modal {
  constructor(app, settings, onSubmit) {
    super(app);
    this.handleInput = () => __async(this, null, function* () {
      try {
        const res = yield getTextOfVerses(this.app, this.userInput, this.pluginSettings);
        this.close();
        this.onSubmit(res);
      } catch (err) {
        return;
      }
    });
    this.onSubmit = onSubmit;
    this.pluginSettings = settings;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: "Copy verse by bible reference" });
    new import_obsidian3.Setting(contentEl).setName("Insert reference").addText((text) => text.onChange((value) => {
      this.userInput = value;
    }).inputEl.focus());
    new import_obsidian3.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Link").setCta().onClick(this.handleInput);
    });
    contentEl.onkeydown = (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        this.handleInput();
      }
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/settings.ts
var import_obsidian4 = __toModule(require("obsidian"));
var SettingsTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian4.Setting(containerEl).setHeading().setName("Copy bible verses settings");
    new import_obsidian4.Setting(containerEl).setName("Verse offset").setDesc('Change this if wrong verses are being linked, e.g. you want "Gen 1,1-3" but output is text from verses 2-4 \u2192 set this to -1').addText((inputBox) => inputBox.setValue(this.plugin.settings.verseOffset.toString()).onChange((value) => __async(this, null, function* () {
      const number = Number.parseInt(value);
      if (value === "-")
        return;
      if (Number.isNaN(number)) {
        new import_obsidian4.Notice("Invalid input, please insert valid integer");
        inputBox.setValue("");
        return;
      }
      this.plugin.settings.verseOffset = number;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Verse heading level").setDesc('If set, only headings of specified level are considered verses (if first heading of this level is always a verse, also set "Verse offset" to -1)').addDropdown((dropdown) => {
      var _a, _b;
      dropdown.addOption("any", "any");
      dropdown.addOption("6", "######");
      dropdown.addOption("5", "#####");
      dropdown.addOption("4", "####");
      dropdown.addOption("3", "###");
      dropdown.addOption("2", "##");
      dropdown.addOption("1", "#");
      dropdown.setValue((_b = (_a = this.plugin.settings.verseHeadingLevel) == null ? void 0 : _a.toString()) != null ? _b : "any");
      dropdown.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.verseHeadingLevel = value === "any" ? void 0 : Number(value);
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian4.Setting(containerEl).setName("Line prefix").setDesc("String inserted in front of every line, for example '>' for quote. Note: If you set 'Put each verse on a new line?' to true, the prefix will be inserted in front of every line.").addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.prefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.prefix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Link postfix").setDesc("String inserted after biblical link, you can use \\n to insert newline.").addText((inputBox) => inputBox.setPlaceholder("Insert postfix here").setValue(this.plugin.settings.postfix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.postfix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Each verse prefix").setDesc('String inserted in front of every copied verse. You can use "{n}" where you want number of given verse inserted, for example "**{n}** " will make each verse start with bold verse number. Leave empty for no prefix.').addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.eachVersePrefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.eachVersePrefix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Link to last verse?").setDesc("Should last verse be linked in the visible link before text of verses?").addToggle((toggle) => toggle.setValue(this.plugin.settings.linkEndVerse).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkEndVerse = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Add invisible links?").setDesc("Invisible links are added to each verse used (so you can find the connections later), they are only visible in source mode.").addToggle((toggle) => toggle.setValue(this.plugin.settings.useInvisibleLinks).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.useInvisibleLinks = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Put each verse on a new line?").setDesc("Each verse is inserted on a new line (with Link prefix).").addToggle((toggle) => toggle.setValue(this.plugin.settings.newLines).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.newLines = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("One verse notation").setDesc('This is the symbol that will be used between chapter number and verse number when copying one verse. For example "." \u2192 Gen 1.1.').addText((inputBox) => inputBox.setPlaceholder("Insert notation symbol here").setValue(this.plugin.settings.oneVerseNotation).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.oneVerseNotation = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Multiple verses notation").setDesc('This is the symbol that will be used between chapter number and verse number when copying multiple verses. For example "," \u2192 Gen 1,1-3.').addText((inputBox) => inputBox.setPlaceholder("Insert notation symbol here").setValue(this.plugin.settings.multipleVersesNotation).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.multipleVersesNotation = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setHeading().setName("Create obsidian links to bible verses settings");
    new import_obsidian4.Setting(containerEl).setName("Link separator").setDesc("This is the separator that will be used when linking, e.g. if you enter '#' here, output will be [[Gen 1#1]]. If you are using headings to mark verses, use '#'. If you are using block references, use '^'.").addText((inputBox) => inputBox.setPlaceholder("Insert separator here").setValue(this.plugin.settings.linkSeparator).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkSeparator = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Verify files?").setDesc("Verify existence of files you are trying to link, so that you are not inserting wrong references by mistake.").addToggle((toggle) => toggle.setValue(this.plugin.settings.verifyFilesWhenLinking).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.verifyFilesWhenLinking = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Verse prefix").setDesc('Fill this if you are using verse prefixes in your bible files, e.g. you have "v1" in your file \u2192 set to "v".').addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.versePrefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.versePrefix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian4.Setting(containerEl).setName("Link type default value").setDesc("Value that will be selected by default in link modal.").addDropdown((dropdown) => {
      dropdown.addOption(LinkType.Basic, LinkType.Basic);
      dropdown.addOption(LinkType.Embedded, LinkType.Embedded);
      dropdown.addOption(LinkType.Invisible, LinkType.Invisible);
      dropdown.setValue(this.plugin.settings.linkTypePreset);
      dropdown.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.linkTypePreset = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian4.Setting(containerEl).setName("Use new lines default value").setDesc("Value that will be selected by default in link modal.").addToggle((toggle) => toggle.setValue(this.plugin.settings.newLinePreset).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.newLinePreset = value;
      yield this.plugin.saveSettings();
    })));
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {
  prefix: "",
  postfix: "",
  linkEndVerse: false,
  verseOffset: 0,
  verseHeadingLevel: void 0,
  useInvisibleLinks: true,
  newLines: false,
  eachVersePrefix: "",
  oneVerseNotation: ".",
  multipleVersesNotation: ",",
  verifyFilesWhenLinking: false,
  versePrefix: "",
  linkTypePreset: LinkType.Basic,
  newLinePreset: true,
  linkSeparator: "#"
};
var BibleLinkerPlugin = class extends import_obsidian5.Plugin {
  constructor() {
    super(...arguments);
    this.openCopyModal = () => {
      const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
      if (view) {
        new CopyVerseModal(this.app, this.settings, (str) => view.editor.replaceRange(str, view.editor.getCursor())).open();
      }
    };
    this.openObsidianLinkModal = () => {
      const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
      if (view) {
        new LinkVerseModal(this.app, this.settings, (str) => view.editor.replaceRange(str, view.editor.getCursor())).open();
      }
    };
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.addSettingTab(new SettingsTab(this.app, this));
      this.addCommand({
        id: "insert-bible-link",
        name: "Copy Bible verses",
        editorCallback: this.openCopyModal
      });
      this.addCommand({
        id: "insert-bible-link-obsidian-link",
        name: "Create Obsidian links to Bible verses",
        editorCallback: this.openObsidianLinkModal
      });
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL21vZGFscy9jb3B5LXZlcnNlLW1vZGFsLnRzIiwgInNyYy91dGlscy9jb252ZXJ0LWxpbmsudHMiLCAic3JjL3V0aWxzL3JlZ2V4ZXMudHMiLCAic3JjL21vZGFscy9saW5rLXZlcnNlLW1vZGFsLnRzIiwgInNyYy9zZXR0aW5ncy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBDb3B5VmVyc2VNb2RhbCBmcm9tICdzcmMvbW9kYWxzL2NvcHktdmVyc2UtbW9kYWwnO1xyXG5pbXBvcnQgTGlua1ZlcnNlTW9kYWwsIHsgTGlua1R5cGUgfSBmcm9tICcuL21vZGFscy9saW5rLXZlcnNlLW1vZGFsJztcclxuaW1wb3J0IHsgU2V0dGluZ3NUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGx1Z2luU2V0dGluZ3Mge1xyXG5cdC8vIENvcHlcclxuXHRwcmVmaXg6IHN0cmluZztcclxuXHRwb3N0Zml4OiBzdHJpbmc7XHJcblx0bGlua0VuZFZlcnNlOiBib29sZWFuO1xyXG5cdHZlcnNlT2Zmc2V0OiBudW1iZXI7XHJcblx0dmVyc2VIZWFkaW5nTGV2ZWw/OiBudW1iZXI7XHJcblx0dXNlSW52aXNpYmxlTGlua3M6IGJvb2xlYW47XHJcblx0bmV3TGluZXM6IGJvb2xlYW47XHJcblx0ZWFjaFZlcnNlUHJlZml4OiBzdHJpbmc7XHJcblx0b25lVmVyc2VOb3RhdGlvbjogc3RyaW5nLFxyXG5cdG11bHRpcGxlVmVyc2VzTm90YXRpb246IHN0cmluZztcclxuXHJcblx0Ly8gTGlua1xyXG5cdHZlcmlmeUZpbGVzV2hlbkxpbmtpbmc6IGJvb2xlYW47XHJcblx0dmVyc2VQcmVmaXg6IHN0cmluZztcclxuXHRsaW5rVHlwZVByZXNldDogTGlua1R5cGU7XHJcblx0bmV3TGluZVByZXNldDogYm9vbGVhbjtcclxuXHRsaW5rU2VwYXJhdG9yOiBzdHJpbmc7XHJcbn1cclxuXHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBhcnRpYWw8UGx1Z2luU2V0dGluZ3M+ID0ge1xyXG5cdC8vIENvcHlcclxuXHRwcmVmaXg6IFwiXCIsXHJcblx0cG9zdGZpeDogXCJcIixcclxuXHRsaW5rRW5kVmVyc2U6IGZhbHNlLFxyXG5cdHZlcnNlT2Zmc2V0OiAwLFxyXG5cdHZlcnNlSGVhZGluZ0xldmVsOiB1bmRlZmluZWQsXHJcblx0dXNlSW52aXNpYmxlTGlua3M6IHRydWUsXHJcblx0bmV3TGluZXM6IGZhbHNlLFxyXG5cdGVhY2hWZXJzZVByZWZpeDogXCJcIixcclxuXHRvbmVWZXJzZU5vdGF0aW9uOiBcIi5cIixcclxuXHRtdWx0aXBsZVZlcnNlc05vdGF0aW9uOiBcIixcIixcclxuXHJcblx0Ly8gTGlua1xyXG5cdHZlcmlmeUZpbGVzV2hlbkxpbmtpbmc6IGZhbHNlLFxyXG5cdHZlcnNlUHJlZml4OiBcIlwiLFxyXG5cdGxpbmtUeXBlUHJlc2V0OiBMaW5rVHlwZS5CYXNpYyxcclxuXHRuZXdMaW5lUHJlc2V0OiB0cnVlLFxyXG5cdGxpbmtTZXBhcmF0b3I6IFwiI1wiXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJpYmxlTGlua2VyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcblxyXG5cdC8vIE9wZW5zIG1vZGFsIGZvciB0ZXh0IGNvcHlpbmdcclxuXHRvcGVuQ29weU1vZGFsID0gKCkgPT4ge1xyXG5cdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcblx0XHRpZiAodmlldykge1xyXG5cdFx0XHRuZXcgQ29weVZlcnNlTW9kYWwodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIFxyXG5cdFx0XHRcdChzdHIpID0+IHZpZXcuZWRpdG9yLnJlcGxhY2VSYW5nZShzdHIsIHZpZXcuZWRpdG9yLmdldEN1cnNvcigpKSkub3BlbigpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gT3BlbnMgbW9kYWwgZm9yIGNyZWF0aW5nIG9ic2lkaWFuIGxpbmtzXHJcblx0b3Blbk9ic2lkaWFuTGlua01vZGFsID0gKCkgPT4ge1xyXG5cdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcblx0XHRpZiAodmlldykge1xyXG5cdFx0XHRuZXcgTGlua1ZlcnNlTW9kYWwodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIFxyXG5cdFx0XHRcdChzdHIpID0+IHZpZXcuZWRpdG9yLnJlcGxhY2VSYW5nZShzdHIsIHZpZXcuZWRpdG9yLmdldEN1cnNvcigpKSkub3BlbigpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpXHJcblx0fVxyXG5cclxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpXHJcblx0fVxyXG5cclxuXHQvLyBSdW4gb25jZSB3aGVuIHBsdWdpbiBpcyBsb2FkZWRcclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHQvLyBIYW5kbGUgc2V0dGluZ3NcclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSlcclxuXHJcblx0XHQvLyBBZGQgaWNvbiB0byBpbnNlcnQgbGluayBcclxuXHRcdC8vIHRoaXMuYWRkUmliYm9uSWNvbihcImxpbmtcIiwgXCJJbnNlcnQgYmlibGUgbGlua1wiLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB0aGlzLm9wZW5Db3B5TW9kYWwoKSk7XHJcblxyXG5cdFx0Ly8gQ29tbWFuZCB0byBpbnNlcnQgbGluayAob25seSBhdmFpbGFibGUgaW4gZWRpdG9yIG1vZGUpXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ2luc2VydC1iaWJsZS1saW5rJywgLy8gSUQgbGVmdCB0byBwcmVzZXJ2ZSB1c2VyJ3Mga2V5IG1hcHBpbmdzXHJcblx0XHRcdG5hbWU6IFwiQ29weSBCaWJsZSB2ZXJzZXNcIixcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IHRoaXMub3BlbkNvcHlNb2RhbFxyXG5cdFx0fSlcclxuXHJcblx0XHQvLyBDb21tYW5kIHRvIGluc2VydCBsaW5rIChvbmx5IGF2YWlsYWJsZSBpbiBlZGl0b3IgbW9kZSlcclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnaW5zZXJ0LWJpYmxlLWxpbmstb2JzaWRpYW4tbGluaycsXHJcblx0XHRcdG5hbWU6IFwiQ3JlYXRlIE9ic2lkaWFuIGxpbmtzIHRvIEJpYmxlIHZlcnNlc1wiLFxyXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogdGhpcy5vcGVuT2JzaWRpYW5MaW5rTW9kYWxcclxuXHRcdH0pXHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IGdldFRleHRPZlZlcnNlcyB9IGZyb20gXCIuLi91dGlscy9jb252ZXJ0LWxpbmtcIjtcclxuaW1wb3J0IHsgUGx1Z2luU2V0dGluZ3MgfSBmcm9tIFwiLi4vbWFpblwiO1xyXG5cclxuLyoqXHJcbiAqIE1vZGFsIHRoYXQgbGV0cyB5b3UgaW5zZXJ0IGJpYmxlIHJlZmVyZW5jZSBieSBjb3B5aW5nIHRleHQgb2YgZ2l2ZW4gdmVyc2VzXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb3B5VmVyc2VNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHVzZXJJbnB1dDogc3RyaW5nXHJcbiAgICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkXHJcbiAgICBwbHVnaW5TZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcblxyXG4gICAgaGFuZGxlSW5wdXQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRUZXh0T2ZWZXJzZXModGhpcy5hcHAsIHRoaXMudXNlcklucHV0LCB0aGlzLnBsdWdpblNldHRpbmdzKTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgdGhpcy5vblN1Ym1pdChyZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncywgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xyXG4gICAgICAgIHRoaXMucGx1Z2luU2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIH1cclxuXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vIEFkZCBoZWFkaW5nIFxyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJDb3B5IHZlcnNlIGJ5IGJpYmxlIHJlZmVyZW5jZVwiIH0pO1xyXG5cclxuICAgICAgICAvLyBBZGQgVGV4dGJveCBmb3IgcmVmZXJlbmNlXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkluc2VydCByZWZlcmVuY2VcIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHRleHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7IHRoaXMudXNlcklucHV0ID0gdmFsdWUgfSlcclxuICAgICAgICAgICAgLmlucHV0RWwuZm9jdXMoKSk7IC8vIFNldHMgZm9jdXMgdG8gaW5wdXQgZmllbGRcclxuXHJcbiAgICAgICAgLy8gQWRkIGJ1dHRvbiBmb3Igc3VibWl0L2V4aXRcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgYnRuXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJMaW5rXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2sodGhpcy5oYW5kbGVJbnB1dClcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEFsbG93IHVzZXIgdG8gZXhpdCB1c2luZyBFbnRlciBrZXlcclxuICAgICAgICBjb250ZW50RWwub25rZXlkb3duID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlSW5wdXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgQXBwLCBIZWFkaW5nQ2FjaGUsIE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgYm9va0FuZENoYXB0ZXJSZWdleEZvck9CU0ssIG11bHRpcGxlVmVyc2VzUmVnRXgsIG9uZVZlcnNlUmVnRXggfSBmcm9tIFwiLi9yZWdleGVzXCI7XHJcbmltcG9ydCB7IFBsdWdpblNldHRpbmdzIH0gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgTGlua1R5cGUgfSBmcm9tIFwic3JjL21vZGFscy9saW5rLXZlcnNlLW1vZGFsXCI7XHJcblxyXG5cclxuXHJcblxyXG5cclxuLyoqXHJcbiAqIENvbnZlcnRzIGJpYmxpY2FsIHJlZmVyZW5jZSB0byBsaW5rcyB0byBnaXZlbiB2ZXJzZXMgXHJcbiAqIEBwYXJhbSBhcHAgQXBwIGluc3RhbmNlXHJcbiAqIEBwYXJhbSB1c2VySW5wdXQgVXNlciBJbnB1dCAobGluayB0byB2ZXJzZSlcclxuICogQHBhcmFtIGxpbmtUeXBlIFR5cGUgb2YgbGluayB0aGF0IHNob3VsZCBiZSB1c2VkXHJcbiAqIEBwYXJhbSB1c2VOZXdMaW5lIFdoZXRoZXIgb3Igbm90IHNob3VsZCBlYWNoIGxpbmsgYmUgb24gbmV3IGxpbmVcclxuICogQHJldHVybnMgU3RyaW5nIHdpdGggcXVvdGUgb2YgbGlua2VkIHZlcnNlcy4gSWYgY29udmVydGluZyB3YXMgbm90IHN1Y2Nlc3NmdWwsIHJldHVybnMgZW1wdHkgc3RyaW5nLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldExpbmtzVG9WZXJzZXMoYXBwOiBBcHAsIHVzZXJJbnB1dDogc3RyaW5nLCBsaW5rVHlwZTogTGlua1R5cGUsIHVzZU5ld0xpbmU6IGJvb2xlYW4sIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncykge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdFxyXG4gICAgbGV0IHsgYm9va0FuZENoYXB0ZXIsIGJlZ2luVmVyc2UsIGVuZFZlcnNlIH0gPSBwYXJzZVVzZXJJbnB1dCh1c2VySW5wdXQpO1xyXG4gICAgYm9va0FuZENoYXB0ZXIgPSBjYXBpdGFsaXplKGJvb2tBbmRDaGFwdGVyKSAvLyBGb3Igb3V0cHV0IGNvbnNpc3RlbmN5XHJcbiAgICBpZiAoc2V0dGluZ3MudmVyaWZ5RmlsZXNXaGVuTGlua2luZykge1xyXG4gICAgICAgIGNvbnN0IHtmaWxlTmFtZSwgdEZpbGV9ID0gZ2V0RmlsZUZyb21Cb29rQW5kQ2hhcHRlcihhcHAsIGJvb2tBbmRDaGFwdGVyKTtcclxuICAgICAgICBpZiAoIXRGaWxlKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEZpbGUgXCIke2ZpbGVOYW1lfVwiIGRvZXMgbm90IGV4aXN0IGFuZCB2ZXJpZnkgZmlsZXMgaXMgc2V0IHRvIHRydWVgKTtcclxuICAgICAgICAgICAgdGhyb3cgYEZpbGUgJHtmaWxlTmFtZX0gZG9lcyBub3QgZXhpc3QsIHZlcmlmeSBmaWxlcyA9IHRydWVgO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoYmVnaW5WZXJzZSA+IGVuZFZlcnNlKSB7XHJcbiAgICAgICAgbmV3IE5vdGljZShcIkJlZ2luIHZlcnNlIGlzIGJpZ2dlciB0aGFuIGVuZCB2ZXJzZVwiKVxyXG4gICAgICAgIHRocm93IFwiQmVnaW4gdmVyc2UgaXMgYmlnZ2VyIHRoYW4gZW5kIHZlcnNlXCJcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVzID0gXCJcIjtcclxuICAgIGNvbnN0IGJlZ2lubmluZyA9IGxpbmtUeXBlID09PSBMaW5rVHlwZS5FbWJlZGRlZCA/IFwiIVwiIDogXCJcIjtcclxuICAgIGNvbnN0IGVuZGluZyA9IGxpbmtUeXBlID09PSBMaW5rVHlwZS5JbnZpc2libGUgPyBcInxcIiA6IFwiXCI7XHJcbiAgICBmb3IgKGxldCBpID0gYmVnaW5WZXJzZTsgaSA8PSBlbmRWZXJzZTsgaSsrKSB7XHJcbiAgICAgICAgcmVzICs9IGAke2JlZ2lubmluZ31bWyR7Ym9va0FuZENoYXB0ZXJ9JHtzZXR0aW5ncy5saW5rU2VwYXJhdG9yfSR7c2V0dGluZ3MudmVyc2VQcmVmaXh9JHtpfSR7ZW5kaW5nfV1dYFxyXG4gICAgICAgIGlmICh1c2VOZXdMaW5lKSB7XHJcbiAgICAgICAgICAgIHJlcyArPSAnXFxuJ1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb252ZXJ0cyBiaWJsaWNhbCByZWZlcmVuY2UgdG8gdGV4dCBvZiBnaXZlbiB2ZXJzZXNcclxuICogQHBhcmFtIGFwcCBBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIHVzZXJJbnB1dCBVc2VyIElucHV0IChsaW5rIHRvIHZlcnNlKVxyXG4gKiBAcmV0dXJucyBTdHJpbmcgd2l0aCBxdW90ZSBvZiBsaW5rZWQgdmVyc2VzLiBJZiBjb252ZXJ0aW5nIHdhcyBub3Qgc3VjY2Vzc2Z1bCwgcmV0dXJucyBlbXB0eSBzdHJpbmcuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VGV4dE9mVmVyc2VzKGFwcDogQXBwLCB1c2VySW5wdXQ6IHN0cmluZywgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdFxyXG4gICAgICAgIGxldCB7Ym9va0FuZENoYXB0ZXIsIGJlZ2luVmVyc2UsIGVuZFZlcnNlfSA9IHBhcnNlVXNlcklucHV0KHVzZXJJbnB1dCk7XHJcbiAgICAgICAgYm9va0FuZENoYXB0ZXIgPSBjYXBpdGFsaXplKGJvb2tBbmRDaGFwdGVyKSAvLyBGb3Igb3V0cHV0IGNvbnNpc3RlbmN5XHJcbiAgICAgICAgY29uc3Qge2ZpbGVOYW1lLCB0RmlsZX0gPSBnZXRGaWxlRnJvbUJvb2tBbmRDaGFwdGVyKGFwcCwgYm9va0FuZENoYXB0ZXIpO1xyXG4gICAgICAgIGlmICh0RmlsZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQ29weU91dHB1dChhcHAsIHRGaWxlLCBib29rQW5kQ2hhcHRlciwgZmlsZU5hbWUsIGJlZ2luVmVyc2UsIGVuZFZlcnNlLCBzZXR0aW5ncyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBGaWxlICR7Ym9va0FuZENoYXB0ZXJ9IG5vdCBmb3VuZGApO1xyXG4gICAgICAgICAgICB0aHJvdyBcIkZpbGUgbm90IGZvdW5kXCJcclxuICAgICAgICB9XHJcbn0gXHJcblxyXG5mdW5jdGlvbiBnZXRGaWxlRnJvbUJvb2tBbmRDaGFwdGVyKGFwcDogQXBwLCBib29rQW5kQ2hhcHRlcjogc3RyaW5nKXtcclxuICAgICAgICBsZXQgZmlsZU5hbWUgPSBib29rQW5kQ2hhcHRlcjsgXHJcbiAgICAgICAgbGV0IHRGaWxlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoZmlsZU5hbWUsIFwiL1wiKVxyXG4gICAgICAgIGlmICghdEZpbGUpIHsgLy8gaGFuZGxlIFwiQmlibGUgc3R1ZHkga2l0XCIgZmlsZSBuYW1pbmcsIGVnLiBHZW4tMDEgaW5zdGVhZCBvZiBHZW4gMVxyXG4gICAgICAgICAgICBmaWxlTmFtZSA9IHRyeUNvbnZlcnRUb09CU0tGaWxlTmFtZShmaWxlTmFtZSk7XHJcbiAgICAgICAgICAgIHRGaWxlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoZmlsZU5hbWUsIFwiL1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtmaWxlTmFtZSwgdEZpbGV9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBwYXJzZVVzZXJJbnB1dCh1c2VySW5wdXQ6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBib29rQW5kQ2hhcHRlcjtcclxuICAgICAgICBsZXQgYmVnaW5WZXJzZTtcclxuICAgICAgICBsZXQgZW5kVmVyc2U7XHJcblxyXG4gICAgICAgIHN3aXRjaCAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjYXNlIG9uZVZlcnNlUmVnRXgudGVzdCh1c2VySW5wdXQpOiB7IC8vIG9uZSB2ZXJzZVxyXG4gICAgICAgICAgICAgICAgY29uc3QgWywgbWF0Y2hlZENoYXB0ZXIsIG1hdGNoZWRWZXJzZV0gPSB1c2VySW5wdXQubWF0Y2gob25lVmVyc2VSZWdFeCkgXHJcbiAgICAgICAgICAgICAgICBib29rQW5kQ2hhcHRlciA9IG1hdGNoZWRDaGFwdGVyO1xyXG4gICAgICAgICAgICAgICAgYmVnaW5WZXJzZSA9IE51bWJlcihtYXRjaGVkVmVyc2UpO1xyXG4gICAgICAgICAgICAgICAgZW5kVmVyc2UgPSBOdW1iZXIobWF0Y2hlZFZlcnNlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgbXVsdGlwbGVWZXJzZXNSZWdFeC50ZXN0KHVzZXJJbnB1dCk6IHsgLy8gbXVsdGlwbGUgdmVyc2VzLCBvbmUgY2hhcHRlclxyXG4gICAgICAgICAgICAgICAgY29uc3QgWywgbWF0Y2hlZENoYXB0ZXIsIG1hdGNoZWRCZWdpblZlcnNlLCBtYXRjaGVkRW5kVmVyc2VdID0gdXNlcklucHV0Lm1hdGNoKG11bHRpcGxlVmVyc2VzUmVnRXgpXHJcbiAgICAgICAgICAgICAgICBib29rQW5kQ2hhcHRlciA9IG1hdGNoZWRDaGFwdGVyO1xyXG4gICAgICAgICAgICAgICAgYmVnaW5WZXJzZSA9IE51bWJlcihtYXRjaGVkQmVnaW5WZXJzZSk7XHJcbiAgICAgICAgICAgICAgICBlbmRWZXJzZSA9IE51bWJlcihtYXRjaGVkRW5kVmVyc2UpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGVmYXVsdDoge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgZm9ybWF0IFwiJHt1c2VySW5wdXR9XCJgKTtcclxuICAgICAgICAgICAgICAgIHRocm93IFwiQ291bGQgbm90IHBhcnNlIHVzZXIgaW5wdXRcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge2Jvb2tBbmRDaGFwdGVyLCBiZWdpblZlcnNlLCBlbmRWZXJzZX1cclxufVxyXG5cclxuLypcclxuICogQ2FwaXRhbGl6ZXMgZ2l2ZW4gc3RyaW5nIChza2lwcyBsZWFkaW5nIHdoaXRlc3BhY2VzIGFuZCBudW1iZXJzKVxyXG4gKi9cclxuZnVuY3Rpb24gY2FwaXRhbGl6ZShzdHI6IHN0cmluZykge1xyXG4gICAgc3RyID0gc3RyLnRvTG9jYWxlTG93ZXJDYXNlKCk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmICgvW15cXHNcXGQuLCMtXS8udGVzdChzdHIuY2hhckF0KGkpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyLnNsaWNlKDAsIGkpICsgc3RyLmNoYXJBdChpKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKGkgKyAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RyO1xyXG59XHJcblxyXG4vKipcclxuICogUmV0dXJucyB0ZXh0IG9mIGdpdmVuIHZlcnNlIHVzaW5nIGdpdmVuIGhlYWRpbmdzIGFuZCBsaW5lcy5cclxuICogQHBhcmFtIHZlcnNlTnVtYmVyIE51bWJlciBvZiBkZXNpcmVkIHZlcnNlLlxyXG4gKiBAcGFyYW0gaGVhZGluZ3MgTGlzdCBvZiBoZWFkaW5ncyB0aGF0IHNob3VsZCBiZSBzZWFyY2hlZC4gU2Vjb25kIGhlYWRpbmcgbXVzdCBjb3JyZXNwb25kIHRvIGZpcnN0IHZlcnNlLCB0aGlyZCBoZWFkaW5nIHRvIHNlY29uZCB2ZXJzZSBhbmQgc28gb24uIFxyXG4gKiBAcGFyYW0gbGluZXMgTGluZXMgb2YgZmlsZSBmcm9tIHdoaWNoIHZlcnNlIHRleHQgc2hvdWxkIGJlIHRha2VuLlxyXG4gKiBAcGFyYW0ga2VlcE5ld2xpbmVzIElmIHNldCB0byB0cnVlLCB0ZXh0IHdpbGwgY29udGFpbiBuZXdsaW5lcyBpZiBwcmVzZW50IGluIHNvdXJjZSwgaWYgc2V0IHRvIGZhbHNlLCBuZXdsaW5lcyB3aWxsIGJlIGNoYW5nZWQgdG8gc3BhY2VzXHJcbiAqIEBwYXJhbSBuZXdMaW5lUHJlZml4IFByZWZpeCBmb3IgZWFjaCBsaW5lIG9mIHZlcnNlLCBpZiB2ZXJzZSBpcyBtdWx0aWxpbmUgYW5kIGtlZXBOZXdMaW5lcyA9IHRydWVcclxuICogQHJldHVybnMgVGV4dCBvZiBnaXZlbiB2ZXJzZS5cclxuICovXHJcbmZ1bmN0aW9uIGdldFZlcnNlVGV4dCh2ZXJzZU51bWJlcjogbnVtYmVyLCBoZWFkaW5nczogSGVhZGluZ0NhY2hlW10sIGxpbmVzOiBzdHJpbmdbXSwga2VlcE5ld2xpbmVzOiBib29sZWFuLCBuZXdMaW5lUHJlZml4OiBzdHJpbmcpIHtcclxuICAgIGlmICh2ZXJzZU51bWJlciA+PSBoZWFkaW5ncy5sZW5ndGgpIHsgLy8gb3V0IG9mIHJhbmdlXHJcbiAgICAgICAgbmV3IE5vdGljZShcIlZlcnNlIG91dCBvZiByYW5nZSBmb3IgZ2l2ZW4gZmlsZVwiKVxyXG4gICAgICAgIHRocm93IGBWZXJzZU51bWJlciAke3ZlcnNlTnVtYmVyfSBpcyBvdXQgb2YgcmFuZ2Ugb2YgaGVhZGluZ3Mgd2l0aCBsZW5ndGggJHtoZWFkaW5ncy5sZW5ndGh9YFxyXG4gICAgfSBcclxuXHJcbiAgICBjb25zdCBoZWFkaW5nTGluZSA9IGhlYWRpbmdzW3ZlcnNlTnVtYmVyXS5wb3NpdGlvbi5zdGFydC5saW5lO1xyXG4gICAgaWYgKGhlYWRpbmdMaW5lICsgMSA+PSBsaW5lcy5sZW5ndGgpIHsgLy8gb3V0IG9mIHJhbmdlXHJcbiAgICAgICAgbmV3IE5vdGljZShcIkxvZ2ljYWwgZXJyb3IgLSBwbGVhc2UgY3JlYXRlIGlzc3VlIG9uIHBsdWdpbidzIEdpdEh1YiB3aXRoIHlvdXIgaW5wdXQgYW5kIHRoZSBmaWxlIHlvdSB3ZXJlIHJlZmVyZW5jaW5nLiBUaGFuayB5b3UhXCIpXHJcbiAgICAgICAgdGhyb3cgYEhlYWRpbmdMaW5lICR7aGVhZGluZ0xpbmUgKyAxfSBpcyBvdXQgb2YgcmFuZ2Ugb2YgbGluZXMgd2l0aCBsZW5ndGggJHtsaW5lc31gXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVGhpcyBwYXJ0IGlzIG5lY2Vzc2FyeSBmb3IgdmVyc2VzIHRoYXQgc3BhbiBvdmVyIG11bHRpcGxlIGxpbmVzXHJcbiAgICBsZXQgb3V0cHV0ID0gXCJcIjtcclxuICAgIGxldCBsaW5lID0gXCJcIjtcclxuICAgIGxldCBpID0gMTsgXHJcbiAgICBsZXQgaXNGaXJzdCA9IHRydWU7XHJcblxyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxyXG4gICAgd2hpbGUodHJ1ZSkge1xyXG4gICAgICAgIGxpbmUgPSBsaW5lc1toZWFkaW5nTGluZSArIGldOyAvLyBnZXQgbmV4dCBsaW5lXHJcbiAgICAgICAgaWYgKC8jLy50ZXN0KGxpbmUpIHx8ICghbGluZSAmJiAhaXNGaXJzdCkpIHtcclxuICAgICAgICAgICAgYnJlYWs7IC8vIGhlYWRpbmcgbGluZSAobmV4dCB2ZXJzZSkgb3IgZW1wdHkgbGluZSBhZnRlciB2ZXJzZSA9PiBkbyBub3QgY29udGludWVcclxuICAgICAgICB9XHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGlmIChsaW5lKSB7IC8vIGlmIGxpbmUgaGFzIGNvbnRlbnQgKGlzIG5vdCBlbXB0eSBzdHJpbmcpXHJcbiAgICAgICAgICAgIGlmICghaXNGaXJzdCkgeyAvLyBJZiBpdCBpcyBub3QgZmlyc3QgbGluZSBvZiB0aGUgdmVyc2UsIGFkZCBkaXZpZGVyXHJcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0ga2VlcE5ld2xpbmVzID8gYFxcbiR7bmV3TGluZVByZWZpeH1gIDogXCIgXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaXNGaXJzdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBvdXRwdXQgKz0gbGluZTtcclxuICAgICAgICB9XHJcbiAgICB9IFxyXG4gICAgcmV0dXJuIG91dHB1dDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRyaWVzIHRvIGNvbnZlcnQgZmlsZSBuYW1lIHRvIE9ic2lkaWFuIFN0dWR5IEtpdCBmaWxlIG5hbWVcclxuICogQHBhcmFtIGJvb2tBbmRDaGFwdGVyIEZpbGUgbmFtZSB0aGF0IHNob3VsZCBiZSBjb252ZXJ0ZWQgXHJcbiAqIEByZXR1cm5zIGZpbGUgbmFtZSBpbiBPYnNpZGFpbiBTdHVkeSBLaXQgbmFtaW5nIHN5c3RlbSBcclxuICovXHJcbmZ1bmN0aW9uIHRyeUNvbnZlcnRUb09CU0tGaWxlTmFtZShib29rQW5kQ2hhcHRlcjogc3RyaW5nKSB7XHJcbiAgICBpZiAoYm9va0FuZENoYXB0ZXJSZWdleEZvck9CU0sudGVzdChib29rQW5kQ2hhcHRlcikpIHsgLy8gVmFsaWQgY2hhcHRlciBuYW1lXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdFxyXG4gICAgICAgIGxldCBbLCBib29rLCBudW1iZXJdID0gYm9va0FuZENoYXB0ZXIubWF0Y2goYm9va0FuZENoYXB0ZXJSZWdleEZvck9CU0spO1xyXG4gICAgICAgIGlmIChudW1iZXIubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgbnVtYmVyID0gYDAke251bWJlcn1gXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBgJHtib29rfS0ke251bWJlcn1gXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXBsYWNlcyBcIlxcblwiIHdpdGggbmV3bGluZSBjaGFyYWN0ZXIgaW4gZ2l2ZW4gc3RyaW5nICh3aGVuIHVzZXIgaW5wdXRzIFwiXFxuXCIgaW4gdGhlIHNldHRpbmdzIGl0IGlzIGF1dG9tYXRpY2FsbHkgY29udmVydGVkIHRvIFwiXFxcXG5cIiBhbmQgZG9lcyBub3Qgd29yayBhcyBuZXdsaW5lKVxyXG4gKi9cclxuZnVuY3Rpb24gcmVwbGFjZU5ld2xpbmUoaW5wdXQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGlucHV0LnJlcGxhY2UoL1xcXFxuL2csIFwiXFxuXCIsICk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvcHlPdXRwdXQoYXBwOiBBcHAsIHRGaWxlOiBURmlsZSwgdXNlckNoYXB0ZXJJbnB1dDogc3RyaW5nLCBmaWxlTmFtZTogc3RyaW5nLCBiZWdpblZlcnNlOiBudW1iZXIsIGVuZFZlcnNlOiBudW1iZXIsIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncykge1xyXG4gICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5yZWFkKHRGaWxlKVxyXG4gICAgY29uc3QgbGluZXMgPSAoYXdhaXQgZmlsZSkuc3BsaXQoL1xccj9cXG4vKVxyXG5cdGNvbnN0IHZlcnNlSGVhZGluZ0xldmVsID0gc2V0dGluZ3MudmVyc2VIZWFkaW5nTGV2ZWxcclxuICAgIGNvbnN0IGhlYWRpbmdzID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKHRGaWxlKS5oZWFkaW5ncy5maWx0ZXIoaGVhZGluZyA9PiAhdmVyc2VIZWFkaW5nTGV2ZWwgfHwgaGVhZGluZy5sZXZlbCA9PT0gdmVyc2VIZWFkaW5nTGV2ZWwpXHJcbiAgICBjb25zdCBiZWdpblZlcnNlTm9PZmZzZXQgPSBiZWdpblZlcnNlXHJcbiAgICBjb25zdCBlbmRWZXJzZU5vT2Zmc2V0ID0gZW5kVmVyc2VcclxuICAgIGJlZ2luVmVyc2UgKz0gc2V0dGluZ3MudmVyc2VPZmZzZXRcclxuICAgIGVuZFZlcnNlICs9IHNldHRpbmdzLnZlcnNlT2Zmc2V0XHJcblxyXG5cclxuICAgIGlmIChiZWdpblZlcnNlID4gZW5kVmVyc2UpIHtcclxuICAgICAgICBuZXcgTm90aWNlKFwiQmVnaW4gdmVyc2UgaXMgYmlnZ2VyIHRoYW4gZW5kIHZlcnNlXCIpXHJcbiAgICAgICAgdGhyb3cgXCJCZWdpbiB2ZXJzZSBpcyBiaWdnZXIgdGhhbiBlbmQgdmVyc2VcIlxyXG4gICAgfVxyXG4gICAgaWYgKGhlYWRpbmdzLmxlbmd0aCA8PSBiZWdpblZlcnNlKSB7XHJcbiAgICAgICAgbmV3IE5vdGljZShcIkJlZ2luIHZlcnNlIG91dCBvZiByYW5nZSBvZiBjaGFwdGVyXCIpXHJcbiAgICAgICAgdGhyb3cgXCJCZWdpbiB2ZXJzZSBvdXQgb2YgcmFuZ2Ugb2YgY2hhcHRlclwiXHJcbiAgICB9XHJcblxyXG4gICAgLy8gMSAtIExpbmsgdG8gdmVyc2VzXHJcbiAgICBsZXQgcmVzID0gc2V0dGluZ3MucHJlZml4O1xyXG5cdGNvbnN0IHBvc3RmaXggPSBzZXR0aW5ncy5wb3N0Zml4ID8gcmVwbGFjZU5ld2xpbmUoc2V0dGluZ3MucG9zdGZpeCkgOiBcIiBcIjtcclxuXHJcbiAgICBpZiAoYmVnaW5WZXJzZSA9PT0gZW5kVmVyc2UpIHtcclxuICAgICAgICByZXMgKz0gYFtbJHtmaWxlTmFtZX0jJHtoZWFkaW5nc1tiZWdpblZlcnNlXS5oZWFkaW5nfXwke3VzZXJDaGFwdGVySW5wdXR9JHtzZXR0aW5ncy5vbmVWZXJzZU5vdGF0aW9ufSR7YmVnaW5WZXJzZU5vT2Zmc2V0fV1dJHtwb3N0Zml4fWAgLy8gW1tHZW4gMSMxfEdlbiAxLDEuMV1dXHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChzZXR0aW5ncy5saW5rRW5kVmVyc2UpIHtcclxuICAgICAgICByZXMgKz0gYFtbJHtmaWxlTmFtZX0jJHtoZWFkaW5nc1tiZWdpblZlcnNlXS5oZWFkaW5nfXwke3VzZXJDaGFwdGVySW5wdXR9JHtzZXR0aW5ncy5tdWx0aXBsZVZlcnNlc05vdGF0aW9ufSR7YmVnaW5WZXJzZU5vT2Zmc2V0fS1dXWAgLy8gW1tHZW4gMSMxfEdlbiAxLDEtXV1cclxuICAgICAgICByZXMgKz0gYFtbJHtmaWxlTmFtZX0jJHtoZWFkaW5nc1tlbmRWZXJzZV0uaGVhZGluZ318JHtlbmRWZXJzZU5vT2Zmc2V0fV1dJHtwb3N0Zml4fWA7IC8vIFtbR2VuIDEjM3wzXV1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJlcyArPSBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdzW2JlZ2luVmVyc2VdLmhlYWRpbmd9fCR7dXNlckNoYXB0ZXJJbnB1dH0ke3NldHRpbmdzLm11bHRpcGxlVmVyc2VzTm90YXRpb259JHtiZWdpblZlcnNlTm9PZmZzZXR9LSR7ZW5kVmVyc2VOb09mZnNldH1dXSR7cG9zdGZpeH1gIC8vIFtbR2VuIDEjMXxHZW4gMSwxLTNdXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIDIgLSBUZXh0IG9mIHZlcnNlc1xyXG4gICAgZm9yIChsZXQgaSA9IGJlZ2luVmVyc2U7IGkgPD0gZW5kVmVyc2U7IGkrKykge1xyXG4gICAgICAgIGxldCBlYWNoVmVyc2VQcmVmaXggPSBcIlwiO1xyXG4gICAgICAgIGlmIChzZXR0aW5ncy5lYWNoVmVyc2VQcmVmaXgpIHtcclxuICAgICAgICAgICAgZWFjaFZlcnNlUHJlZml4ICs9IHNldHRpbmdzLmVhY2hWZXJzZVByZWZpeC5yZXBsYWNlKFwie259XCIsIChpIC0gc2V0dGluZ3MudmVyc2VPZmZzZXQpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB2ZXJzZVRleHQgPSBnZXRWZXJzZVRleHQoaSwgaGVhZGluZ3MsIGxpbmVzLCBzZXR0aW5ncy5uZXdMaW5lcywgc2V0dGluZ3MucHJlZml4KTtcclxuXHRcdGlmIChzZXR0aW5ncy5uZXdMaW5lcykge1xyXG5cdFx0XHRyZXMgKz0gXCJcXG5cIiArIHNldHRpbmdzLnByZWZpeCArIGVhY2hWZXJzZVByZWZpeCArIHZlcnNlVGV4dDtcclxuXHRcdH0gXHJcbiAgICAgICAgZWxzZSB7XHJcblx0XHRcdHJlcyArPSBlYWNoVmVyc2VQcmVmaXggKyB2ZXJzZVRleHQgKyBcIiBcIjtcclxuXHRcdH1cclxuICAgIH1cclxuXHJcbiAgICAvLyAzIC0gSW52aXNpYmxlIGxpbmtzXHJcbiAgICBpZiAoYmVnaW5WZXJzZSA9PSBlbmRWZXJzZSB8fCAhc2V0dGluZ3MudXNlSW52aXNpYmxlTGlua3MpIHJldHVybiByZXM7IC8vIE5vIG5lZWQgdG8gYWRkIGFub3RoZXIgbGluaywgd2hlbiBvbmx5IG9uZSB2ZXJzZSBpcyBiZWluZyBsaW5rZWRcclxuICAgIGlmIChzZXR0aW5ncy5uZXdMaW5lcykge1xyXG4gICAgICAgIHJlcyArPSBgXFxuJHtzZXR0aW5ncy5wcmVmaXh9YDtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSBiZWdpblZlcnNlOyBpIDw9IGVuZFZlcnNlOyBpKyspIHtcclxuICAgICAgICByZXMgKz0gYFtbJHtmaWxlTmFtZX0jJHtoZWFkaW5nc1tpXS5oZWFkaW5nfXxdXWBcclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuIiwgIi8qXHJcbiogUmVnZXhlcyBmb3IgdmVyc2UgcGFyc2luZ1xyXG4qL1xyXG5cclxuLy8gTGluayB0byBvbmUgdmVyc2UsIGZvciBleGFtcGxlIFwiR2VuIDEuMVwiIG9yIFwiR2VuIDE6MVwiXHJcbmV4cG9ydCBjb25zdCBvbmVWZXJzZVJlZ0V4ID0gbmV3IFJlZ0V4cCgvKFteLDojXSspWywjLjo7XVxccyooXFxkKylcXHMqJC8pO1xyXG5cclxuLy8gTGluayB0byBtdWx0aXBsZSB2ZXJzZXMsIGZvciBleGFtcGxlIFwiR2VuIDEsMS01XCJcclxuZXhwb3J0IGNvbnN0IG11bHRpcGxlVmVyc2VzUmVnRXggPSBuZXcgUmVnRXhwKC8oW14sOiNdKylbLCMuOjtdXFxzKihcXGQrKVxccypbLS49XVxccyooXFxkKylcXHMqJC8pO1xyXG5cclxuLy8gQm9vayBhbmQgY2hhcHRlciBzdHJpbmcgKHVzZWQgZm9yIGNvbnZlcnRpbmcgdG8gYmlibGUgc3R1ZHkga2l0IGZpbGUgbmFtZXMpXHJcbmV4cG9ydCBjb25zdCBib29rQW5kQ2hhcHRlclJlZ2V4Rm9yT0JTSyA9IC8oW14sOiNdKylcXHMoXFxkKykvIiwgIlxyXG5pbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7Z2V0TGlua3NUb1ZlcnNlc30gZnJvbSBcIi4uL3V0aWxzL2NvbnZlcnQtbGlua1wiO1xyXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gXCIuLi9tYWluXCI7XHJcblxyXG5leHBvcnQgZW51bSBMaW5rVHlwZSB7XHJcbiAgICBCYXNpYyA9IFwiQmFzaWNcIixcclxuICAgIEVtYmVkZGVkID0gXCJFbWJlZGRlZFwiLFxyXG4gICAgSW52aXNpYmxlID0gXCJJbnZpc2libGVcIixcclxufVxyXG5cclxuLyoqXHJcbiAqIE1vZGFsIHRoYXQgbGV0cyB5b3UgaW5zZXJ0IGJpYmxlIHJlZmVyZW5jZSBieSB1c2luZyBPYnNpZGlhbiBsaW5rcyBcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExpbmtWZXJzZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgdXNlcklucHV0OiBzdHJpbmc7XHJcbiAgICBsaW5rVHlwZTogTGlua1R5cGU7XHJcbiAgICB1c2VOZXdMaW5lOiBib29sZWFuO1xyXG4gICAgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZDtcclxuICAgIHBsdWdpblNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncztcclxuXHJcbiAgICBoYW5kbGVJbnB1dCA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRMaW5rc1RvVmVyc2VzKHRoaXMuYXBwLCB0aGlzLnVzZXJJbnB1dCwgdGhpcy5saW5rVHlwZSwgdGhpcy51c2VOZXdMaW5lLCB0aGlzLnBsdWdpblNldHRpbmdzKVxyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXQocmVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICByZXR1cm4gXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MsIG9uU3VibWl0OiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcclxuICAgICAgICB0aGlzLnBsdWdpblNldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICAgICAgdGhpcy5saW5rVHlwZSA9IHRoaXMucGx1Z2luU2V0dGluZ3MubGlua1R5cGVQcmVzZXQ7XHJcbiAgICAgICAgdGhpcy51c2VOZXdMaW5lID0gdGhpcy5wbHVnaW5TZXR0aW5ncy5uZXdMaW5lUHJlc2V0O1xyXG4gICAgfVxyXG5cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHJcbiAgICAgICAgLy8gQWRkIGhlYWRpbmcgXHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIkNyZWF0ZSBPYnNpZGlhbiBsaW5rcyBmcm9tIEJpYmxlIHJlZmVyZW5jZVwiIH0pO1xyXG5cclxuICAgICAgICAvLyBBZGQgVGV4dGJveCBmb3IgcmVmZXJlbmNlXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkluc2VydCByZWZlcmVuY2VcIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHRleHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7IHRoaXMudXNlcklucHV0ID0gdmFsdWUgfSlcclxuICAgICAgICAgICAgLmlucHV0RWwuZm9jdXMoKSk7IC8vIFNldHMgZm9jdXMgdG8gaW5wdXQgZmllbGRcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkxpbmsgdHlwZVwiKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oTGlua1R5cGUuQmFzaWMsIExpbmtUeXBlLkJhc2ljKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKExpbmtUeXBlLkVtYmVkZGVkLCBMaW5rVHlwZS5FbWJlZGRlZClcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihMaW5rVHlwZS5JbnZpc2libGUsIExpbmtUeXBlLkludmlzaWJsZSlcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKCh2YWx1ZSkgPT4gdGhpcy5saW5rVHlwZSA9IHZhbHVlIGFzIExpbmtUeXBlKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW5TZXR0aW5ncy5saW5rVHlwZVByZXNldClcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkVhY2ggbGluayBvbiBuZXcgbGluZT9cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodGdsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGdsLnNldFZhbHVlKHRoaXMucGx1Z2luU2V0dGluZ3MubmV3TGluZVByZXNldClcclxuICAgICAgICAgICAgICAgICAgICB0Z2wub25DaGFuZ2UodmFsID0+IHRoaXMudXNlTmV3TGluZSA9IHZhbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuXHJcblxyXG4gICAgICAgIC8vIEFkZCBidXR0b24gZm9yIHN1Ym1pdC9leGl0XHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0blxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiTGlua1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKHRoaXMuaGFuZGxlSW5wdXQpXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBBbGxvdyB1c2VyIHRvIGV4aXQgdXNpbmcgRW50ZXIga2V5XHJcbiAgICAgICAgY29udGVudEVsLm9ua2V5ZG93biA9IChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVudGVyXCIpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUlucHV0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBCaWJsZUxpbmtlclBsdWdpbiBmcm9tIFwiLi9tYWluXCI7XHJcbmltcG9ydCB7IExpbmtUeXBlIH0gZnJvbSBcIi4vbW9kYWxzL2xpbmstdmVyc2UtbW9kYWxcIjtcclxuXHJcbi8qKlxyXG4gKiBTZXR0aW5ncyBmb3IgcGx1Z2luXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogQmlibGVMaW5rZXJQbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQmlibGVMaW5rZXJQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47ICBcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXRIZWFkaW5nKClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJDb3B5IGJpYmxlIHZlcnNlcyBzZXR0aW5nc1wiKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJWZXJzZSBvZmZzZXRcIilcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NoYW5nZSB0aGlzIGlmIHdyb25nIHZlcnNlcyBhcmUgYmVpbmcgbGlua2VkLCBlLmcuIHlvdSB3YW50IFwiR2VuIDEsMS0zXCIgYnV0IG91dHB1dCBpcyB0ZXh0IGZyb20gdmVyc2VzIDItNCBcdTIxOTIgc2V0IHRoaXMgdG8gLTEnKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgoaW5wdXRCb3gpID0+IFxyXG4gICAgICAgICAgICAgICAgaW5wdXRCb3hcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VPZmZzZXQudG9TdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bWJlciA9IE51bWJlci5wYXJzZUludCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gXCItXCIpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE51bWJlci5pc05hTihudW1iZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiSW52YWxpZCBpbnB1dCwgcGxlYXNlIGluc2VydCB2YWxpZCBpbnRlZ2VyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRCb3guc2V0VmFsdWUoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VPZmZzZXQgPSBudW1iZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJWZXJzZSBoZWFkaW5nIGxldmVsXCIpXHJcblx0XHRcdC5zZXREZXNjKCdJZiBzZXQsIG9ubHkgaGVhZGluZ3Mgb2Ygc3BlY2lmaWVkIGxldmVsIGFyZSBjb25zaWRlcmVkIHZlcnNlcyAoaWYgZmlyc3QgaGVhZGluZyBvZiB0aGlzIGxldmVsIGlzIGFsd2F5cyBhIHZlcnNlLCBhbHNvIHNldCBcIlZlcnNlIG9mZnNldFwiIHRvIC0xKScpXHJcblx0XHRcdC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcclxuXHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24oXCJhbnlcIiwgXCJhbnlcIilcclxuXHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24oXCI2XCIsIFwiIyMjIyMjXCIpXHJcblx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKFwiNVwiLCBcIiMjIyMjXCIpXHJcblx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKFwiNFwiLCBcIiMjIyNcIilcclxuXHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24oXCIzXCIsIFwiIyMjXCIpXHJcblx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKFwiMlwiLCBcIiMjXCIpXHJcblx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKFwiMVwiLCBcIiNcIilcclxuXHRcdFx0XHRkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJzZUhlYWRpbmdMZXZlbD8udG9TdHJpbmcoKSA/PyBcImFueVwiKVxyXG5cdFx0XHRcdGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VIZWFkaW5nTGV2ZWwgPSB2YWx1ZSA9PT0gXCJhbnlcIiA/IHVuZGVmaW5lZCA6IE51bWJlcih2YWx1ZSk7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHR9KVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5lIHByZWZpeFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlN0cmluZyBpbnNlcnRlZCBpbiBmcm9udCBvZiBldmVyeSBsaW5lLCBmb3IgZXhhbXBsZSAnPicgZm9yIHF1b3RlLiBOb3RlOiBJZiB5b3Ugc2V0ICdQdXQgZWFjaCB2ZXJzZSBvbiBhIG5ldyBsaW5lPycgdG8gdHJ1ZSwgdGhlIHByZWZpeCB3aWxsIGJlIGluc2VydGVkIGluIGZyb250IG9mIGV2ZXJ5IGxpbmUuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBwcmVmaXggaGVyZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVmaXgpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVmaXggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5rIHBvc3RmaXhcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJTdHJpbmcgaW5zZXJ0ZWQgYWZ0ZXIgYmlibGljYWwgbGluaywgeW91IGNhbiB1c2UgXFxcXG4gdG8gaW5zZXJ0IG5ld2xpbmUuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBwb3N0Zml4IGhlcmVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucG9zdGZpeClcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBvc3RmaXggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJFYWNoIHZlcnNlIHByZWZpeFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlN0cmluZyBpbnNlcnRlZCBpbiBmcm9udCBvZiBldmVyeSBjb3BpZWQgdmVyc2UuIFlvdSBjYW4gdXNlIFxcXCJ7bn1cXFwiIHdoZXJlIHlvdSB3YW50IG51bWJlciBvZiBnaXZlbiB2ZXJzZSBpbnNlcnRlZCwgZm9yIGV4YW1wbGUgXFxcIioqe259KiogXFxcIiB3aWxsIG1ha2UgZWFjaCB2ZXJzZSBzdGFydCB3aXRoIGJvbGQgdmVyc2UgbnVtYmVyLiBMZWF2ZSBlbXB0eSBmb3Igbm8gcHJlZml4LlwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgoaW5wdXRCb3gpID0+XHJcbiAgICAgICAgICAgICAgICBpbnB1dEJveCAgICBcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJJbnNlcnQgcHJlZml4IGhlcmVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZWFjaFZlcnNlUHJlZml4KVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZWFjaFZlcnNlUHJlZml4ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayB0byBsYXN0IHZlcnNlP1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlNob3VsZCBsYXN0IHZlcnNlIGJlIGxpbmtlZCBpbiB0aGUgdmlzaWJsZSBsaW5rIGJlZm9yZSB0ZXh0IG9mIHZlcnNlcz9cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiBcclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rRW5kVmVyc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rRW5kVmVyc2UgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJBZGQgaW52aXNpYmxlIGxpbmtzP1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIkludmlzaWJsZSBsaW5rcyBhcmUgYWRkZWQgdG8gZWFjaCB2ZXJzZSB1c2VkIChzbyB5b3UgY2FuIGZpbmQgdGhlIGNvbm5lY3Rpb25zIGxhdGVyKSwgdGhleSBhcmUgb25seSB2aXNpYmxlIGluIHNvdXJjZSBtb2RlLlwiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IFxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUludmlzaWJsZUxpbmtzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlSW52aXNpYmxlTGlua3MgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJQdXQgZWFjaCB2ZXJzZSBvbiBhIG5ldyBsaW5lP1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIkVhY2ggdmVyc2UgaXMgaW5zZXJ0ZWQgb24gYSBuZXcgbGluZSAod2l0aCBMaW5rIHByZWZpeCkuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdMaW5lcylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm5ld0xpbmVzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiT25lIHZlcnNlIG5vdGF0aW9uXCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVGhpcyBpcyB0aGUgc3ltYm9sIHRoYXQgd2lsbCBiZSB1c2VkIGJldHdlZW4gY2hhcHRlciBudW1iZXIgYW5kIHZlcnNlIG51bWJlciB3aGVuIGNvcHlpbmcgb25lIHZlcnNlLiBGb3IgZXhhbXBsZSBcXFwiLlxcXCIgXHUyMTkyIEdlbiAxLjEuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBub3RhdGlvbiBzeW1ib2wgaGVyZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbmVWZXJzZU5vdGF0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub25lVmVyc2VOb3RhdGlvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIk11bHRpcGxlIHZlcnNlcyBub3RhdGlvblwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoaXMgaXMgdGhlIHN5bWJvbCB0aGF0IHdpbGwgYmUgdXNlZCBiZXR3ZWVuIGNoYXB0ZXIgbnVtYmVyIGFuZCB2ZXJzZSBudW1iZXIgd2hlbiBjb3B5aW5nIG11bHRpcGxlIHZlcnNlcy4gRm9yIGV4YW1wbGUgXFxcIixcXFwiIFx1MjE5MiBHZW4gMSwxLTMuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBub3RhdGlvbiBzeW1ib2wgaGVyZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tdWx0aXBsZVZlcnNlc05vdGF0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubXVsdGlwbGVWZXJzZXNOb3RhdGlvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgICAgIC8vIExJTksgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldEhlYWRpbmcoKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNyZWF0ZSBvYnNpZGlhbiBsaW5rcyB0byBiaWJsZSB2ZXJzZXMgc2V0dGluZ3NcIilcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayBzZXBhcmF0b3JcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJUaGlzIGlzIHRoZSBzZXBhcmF0b3IgdGhhdCB3aWxsIGJlIHVzZWQgd2hlbiBsaW5raW5nLCBlLmcuIGlmIHlvdSBlbnRlciAnIycgaGVyZSwgb3V0cHV0IHdpbGwgYmUgW1tHZW4gMSMxXV0uIElmIHlvdSBhcmUgdXNpbmcgaGVhZGluZ3MgdG8gbWFyayB2ZXJzZXMsIHVzZSAnIycuIElmIHlvdSBhcmUgdXNpbmcgYmxvY2sgcmVmZXJlbmNlcywgdXNlICdeJy5cIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKGlucHV0Qm94KSA9PlxyXG4gICAgICAgICAgICAgICAgaW5wdXRCb3ggICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiSW5zZXJ0IHNlcGFyYXRvciBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtTZXBhcmF0b3IpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rU2VwYXJhdG9yID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiVmVyaWZ5IGZpbGVzP1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlZlcmlmeSBleGlzdGVuY2Ugb2YgZmlsZXMgeW91IGFyZSB0cnlpbmcgdG8gbGluaywgc28gdGhhdCB5b3UgYXJlIG5vdCBpbnNlcnRpbmcgd3JvbmcgcmVmZXJlbmNlcyBieSBtaXN0YWtlLlwiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyaWZ5RmlsZXNXaGVuTGlua2luZylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnZlcmlmeUZpbGVzV2hlbkxpbmtpbmcgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJWZXJzZSBwcmVmaXhcIilcclxuICAgICAgICAgICAgLnNldERlc2MoJ0ZpbGwgdGhpcyBpZiB5b3UgYXJlIHVzaW5nIHZlcnNlIHByZWZpeGVzIGluIHlvdXIgYmlibGUgZmlsZXMsIGUuZy4geW91IGhhdmUgXCJ2MVwiIGluIHlvdXIgZmlsZSBcdTIxOTIgc2V0IHRvIFwidlwiLicpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBwcmVmaXggaGVyZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJzZVByZWZpeClcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnZlcnNlUHJlZml4ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayB0eXBlIGRlZmF1bHQgdmFsdWVcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJWYWx1ZSB0aGF0IHdpbGwgYmUgc2VsZWN0ZWQgYnkgZGVmYXVsdCBpbiBsaW5rIG1vZGFsLlwiKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oTGlua1R5cGUuQmFzaWMsIExpbmtUeXBlLkJhc2ljKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKExpbmtUeXBlLkVtYmVkZGVkLCBMaW5rVHlwZS5FbWJlZGRlZClcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihMaW5rVHlwZS5JbnZpc2libGUsIExpbmtUeXBlLkludmlzaWJsZSlcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtUeXBlUHJlc2V0KVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1R5cGVQcmVzZXQgPSB2YWx1ZSBhcyBMaW5rVHlwZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIlVzZSBuZXcgbGluZXMgZGVmYXVsdCB2YWx1ZVwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlZhbHVlIHRoYXQgd2lsbCBiZSBzZWxlY3RlZCBieSBkZWZhdWx0IGluIGxpbmsgbW9kYWwuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdMaW5lUHJlc2V0KVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubmV3TGluZVByZXNldCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgfVxyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQXFDOzs7QUNBckMsdUJBQW9DOzs7QUNBcEMsdUJBQWlEOzs7QUNLMUMsSUFBTSxnQkFBZ0IsSUFBSSxPQUFPO0FBR2pDLElBQU0sc0JBQXNCLElBQUksT0FBTztBQUd2QyxJQUFNLDZCQUE2Qjs7O0FDVjFDLHNCQUFvQztBQUk3QixJQUFLO0FBQUwsVUFBSyxXQUFMO0FBQ0gsdUJBQVE7QUFDUiwwQkFBVztBQUNYLDJCQUFZO0FBQUEsR0FISjtBQVNaLG1DQUE0QyxzQkFBTTtBQUFBLEVBa0I5QyxZQUFZLEtBQVUsVUFBMEIsVUFBb0M7QUFDaEYsVUFBTTtBQVpWLHVCQUFjLE1BQVk7QUFDdEIsVUFBSTtBQUNBLGNBQU0sTUFBTSxNQUFNLGlCQUFpQixLQUFLLEtBQUssS0FBSyxXQUFXLEtBQUssVUFBVSxLQUFLLFlBQVksS0FBSztBQUNsRyxhQUFLO0FBQ0wsYUFBSyxTQUFTO0FBQUEsZUFFWCxLQUFQO0FBQ0k7QUFBQTtBQUFBO0FBTUosU0FBSyxXQUFXO0FBQ2hCLFNBQUssaUJBQWlCO0FBQ3RCLFNBQUssV0FBVyxLQUFLLGVBQWU7QUFDcEMsU0FBSyxhQUFhLEtBQUssZUFBZTtBQUFBO0FBQUEsRUFHMUMsU0FBUztBQUNMLFVBQU0sRUFBRSxjQUFjO0FBR3RCLGNBQVUsU0FBUyxNQUFNLEVBQUUsTUFBTTtBQUdqQyxRQUFJLHdCQUFRLFdBQ1AsUUFBUSxvQkFDUixRQUFRLENBQUMsU0FBUyxLQUFLLFNBQVMsQ0FBQyxVQUFVO0FBQUUsV0FBSyxZQUFZO0FBQUEsT0FDOUQsUUFB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
